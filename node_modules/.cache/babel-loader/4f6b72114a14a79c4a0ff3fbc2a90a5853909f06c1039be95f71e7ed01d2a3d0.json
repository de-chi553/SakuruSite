{"ast":null,"code":"import React,{useEffect,useState}from'react';import{db,storage}from'../firebase';import{collection,query,where,getDocs}from'firebase/firestore';import{ref,getDownloadURL}from'firebase/storage';import'./styles.css';import'firebase/firestore';import'firebase/storage';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const All=_ref=>{let{selectedUniversity}=_ref;const[posts,setPosts]=useState([]);const[currentIndex,setCurrentIndex]=useState(0);useEffect(()=>{const fetchPosts=async()=>{try{const q=query(collection(db,'Post'),where('college','==',selectedUniversity),where('Field.field','in',['体育系','研究系','文化系']));const querySnapshot=await getDocs(q);const fetchedPosts=[];for(const doc of querySnapshot.docs){var _postData$Field,_postData$Field$Conte;const postData=doc.data();let imageUrl=null;if((_postData$Field=postData.Field)!==null&&_postData$Field!==void 0&&(_postData$Field$Conte=_postData$Field.Content)!==null&&_postData$Field$Conte!==void 0&&_postData$Field$Conte.imageRandomId){try{const imageRef=ref(storage,\"images/\".concat(postData.userID,\"/\").concat(postData.Field.Content.imageRandomId));imageUrl=await getDownloadURL(imageRef);console.log('Image URL:',imageUrl);}catch(imageError){console.error('Error fetching image URL:',imageError.message);}}fetchedPosts.push({id:doc.id,...postData,imageUrl});}setPosts(fetchedPosts);}catch(error){console.error('Error fetching posts:',error.message);}};fetchPosts();},[selectedUniversity]);const nextPosts=()=>{if(currentIndex+4<posts.length){setCurrentIndex(currentIndex+4);}};const prevPosts=()=>{if(currentIndex-4>=0){setCurrentIndex(currentIndex-4);}};const PostItem=_ref2=>{var _post$Field,_post$Field$Content,_post$Field2,_post$Field2$Content;let{post}=_ref2;return/*#__PURE__*/_jsx(\"div\",{className:\"postContainer\",style:{flex:1},children:/*#__PURE__*/_jsxs(\"div\",{className:\"postContent\",children:[post.imageUrl&&/*#__PURE__*/_jsx(\"img\",{src:post.imageUrl,className:\"image\",alt:\"Post\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"textContainer\",style:{flex:1},children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u30E6\\u30FC\\u30B6\\u30FC\\u540D: \",post.username]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u6295\\u7A3F\\u5185\\u5BB9: \",(_post$Field=post.Field)===null||_post$Field===void 0?void 0:(_post$Field$Content=_post$Field.Content)===null||_post$Field$Content===void 0?void 0:_post$Field$Content.contents]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u6D3B\\u52D5\\u5834\\u6240: \",(_post$Field2=post.Field)===null||_post$Field2===void 0?void 0:(_post$Field2$Content=_post$Field2.Content)===null||_post$Field2$Content===void 0?void 0:_post$Field2$Content.actplace]})]})]})});};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:posts.slice(currentIndex,currentIndex+2).map(post=>/*#__PURE__*/_jsx(PostItem,{post:post},post.id))}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:posts.slice(currentIndex+2,currentIndex+4).map(post=>/*#__PURE__*/_jsx(PostItem,{post:post},post.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"buttonContainer\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:prevPosts,className:\"button\",disabled:currentIndex===0,children:\"\\u524D\\u3078\"}),/*#__PURE__*/_jsx(\"button\",{onClick:nextPosts,className:\"button\",disabled:currentIndex+4>=posts.length,children:\"\\u6B21\\u3078\"})]})]});};export default All;","map":{"version":3,"names":["React","useEffect","useState","db","storage","collection","query","where","getDocs","ref","getDownloadURL","jsx","_jsx","jsxs","_jsxs","All","_ref","selectedUniversity","posts","setPosts","currentIndex","setCurrentIndex","fetchPosts","q","querySnapshot","fetchedPosts","doc","docs","_postData$Field","_postData$Field$Conte","postData","data","imageUrl","Field","Content","imageRandomId","imageRef","concat","userID","console","log","imageError","error","message","push","id","nextPosts","length","prevPosts","PostItem","_ref2","_post$Field","_post$Field$Content","_post$Field2","_post$Field2$Content","post","className","style","flex","children","src","alt","username","contents","actplace","slice","map","onClick","disabled"],"sources":["/Users/okataichi/Desktop/SakuruSite/src/components/All.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { db, storage } from '../firebase';\nimport { collection, query, where, getDocs } from 'firebase/firestore';\nimport { ref, getDownloadURL } from 'firebase/storage';\nimport './styles.css';\nimport 'firebase/firestore';\nimport 'firebase/storage';\n\nconst All = ({ selectedUniversity }) => {\n  const [posts, setPosts] = useState([]);\n  const [currentIndex, setCurrentIndex] = useState(0);\n\n  useEffect(() => {\n    const fetchPosts = async () => {\n      \n\n      try {\n\n        const q = query(\n          collection(db, 'Post'),\n          where('college', '==', selectedUniversity),\n          where('Field.field', 'in', ['体育系', '研究系', '文化系'])\n        );\n\n        const querySnapshot = await getDocs(q);\n\n        \n\n        const fetchedPosts = [];\n\n        for (const doc of querySnapshot.docs) {\n          const postData = doc.data();\n\n          let imageUrl = null;\n          if (postData.Field?.Content?.imageRandomId) {\n            try {\n              const imageRef = ref(storage, `images/${postData.userID}/${postData.Field.Content.imageRandomId}`);\n              imageUrl = await getDownloadURL(imageRef);\n              console.log('Image URL:', imageUrl);\n            } catch (imageError) {\n              console.error('Error fetching image URL:', imageError.message);\n            }\n          }\n\n          fetchedPosts.push({ id: doc.id, ...postData, imageUrl });\n        }\n\n        setPosts(fetchedPosts);\n      } catch (error) {\n        console.error('Error fetching posts:', error.message);\n      }\n    };\n\n    fetchPosts();\n  }, [selectedUniversity]);\n\n  const nextPosts = () => {\n    if (currentIndex + 4 < posts.length) {\n      setCurrentIndex(currentIndex + 4);\n    }\n  };\n\n  const prevPosts = () => {\n    if (currentIndex - 4 >= 0) {\n      setCurrentIndex(currentIndex - 4);\n    }\n  };\n\n  const PostItem = ({ post }) => (\n    <div className=\"postContainer\" style={{ flex: 1 }}>\n      <div className=\"postContent\">\n        {post.imageUrl && <img src={post.imageUrl} className=\"image\" alt=\"Post\" />}\n        <div className=\"textContainer\" style={{ flex: 1 }}>\n          <p>ユーザー名: {post.username}</p>\n          <p>投稿内容: {post.Field?.Content?.contents}</p>\n          <p>活動場所: {post.Field?.Content?.actplace}</p>\n        </div>\n      </div>\n    </div>\n  );\n\n  return (\n    <div className=\"container\">\n      <div className=\"row\">\n        {posts.slice(currentIndex, currentIndex + 2).map((post) => (\n          <PostItem key={post.id} post={post} />\n        ))}\n      </div>\n      <div className=\"row\">\n        {posts.slice(currentIndex + 2, currentIndex + 4).map((post) => (\n          <PostItem key={post.id} post={post} />\n        ))}\n      </div>\n      <div className=\"buttonContainer\">\n        <button onClick={prevPosts} className=\"button\" disabled={currentIndex === 0}>前へ</button>\n        <button onClick={nextPosts} className=\"button\" disabled={currentIndex + 4 >= posts.length}>次へ</button>\n      </div>\n    </div>\n  );\n};\n\nexport default All;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}